import sys
import logging

from database import Database

logging.basicConfig(level=logging.INFO, format="%(message)s")
# logging.getLogger('sqlalchemy.engine').setLevel(logging.INFO)

def main():
    if len(sys.argv) != 2:
        logging.error("Usage: python %s <product> <product> <version>" % sys.argv[0])
        logging.info("Example: python %s 'winamp'" % sys.argv[0])
        exit(1)

    product = sys.argv[1]

    cpes = Database().get_cpe_vendors_by_wfn_product(product)
    logging.info("Found %d CPEs:" % len(cpes))

    logging.info("{:20}CPE URI".format("Vendor"))
    for cpe in cpes:
        uri = cpe["uri_binding"]
        vendor = cpe["vendor"]
        logging.info("{:20}{:}".format(vendor, uri))

if __name__ == '__main__':
    main()
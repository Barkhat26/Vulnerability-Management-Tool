from marshmallow import Schema, fields

class WFNSchema(Schema):
    part = fields.Str()
    vendor = fields.Str()
    product = fields.Str()
    version = fields.Str()
    update = fields.Str()
    edition = fields.Str()
    language = fields.Str()
    sw_edition = fields.Str()
    target_sw = fields.Str()
    target_hw = fields.Str()
    other = fields.Str()

class CPESchema(Schema):
    uri_binding = fields.Str()
    wfn = fields.Nested(WFNSchema)
    formatted_string_binding = fields.Str()

class ImpactSchema(Schema):
    availability = fields.Str()
    confidentiality = fields.Str()
    integrity = fields.Str()

class AccessSchema(Schema):
    authentication = fields.Str()
    complexity = fields.Str()
    vector = fields.Str()


class CVESchema(Schema):
    cve_id = fields.Str()
    assigner = fields.Str()
    published = fields.Str()
    modified = fields.Str()
    summary = fields.Str()
    access = fields.Nested(AccessSchema)
    impact = fields.Nested(ImpactSchema)
    cvss = fields.Str()
    cvss_time = fields.Str()
    cvss_vector = fields.Str()
    cwe = fields.Str()
    cpe_entries = fields.List(fields.Str())
    references = fields.List(fields.Str())


cpe_schema = CPESchema()
cve_schema = CVESchema()
